(function(t,M,h,z,l){var v={main:function(){t("#aios-communities-details-meta-box").insertAfter("#titlediv")},init:function(){this.main()}},p={main:function(){let e;t(l).on("click","[dat-add-images]",function(){const i=t(this),a=i.parent(),o=a.find('input[type="hidden"]'),n=o.val()?o.val().split(","):[];e=wp.media({title:"Select or Upload Media",button:{text:"Insert Media"},multiple:!0}),e.on("select",function(){const d=e.state().get("selection"),c=a.find(".wc-repeater-field-content-no-images"),f=a.find(".wc-repeater-field-content-gallery");d.length&&(d.forEach(function(r){n.includes(String(r.id))||(n.push(r.id),f.append(`<div>
									<div class="img-move-drag" data-sort-handle></div>
									<div class="img-remove" data-remove-image-gallery></div>
									<img src="${r.attributes.url}" width="150" height="150" data-id="${r.attributes.id}">
									<canvas width="150" height="150"></canvas>
								</div>`))}),o.val(n.join(",")),c.hide())}),e.on("close",function(){const d=a.find(".wc-repeater-field-content-no-images");o.val()===""?d.show():d.hide()}),e.open()})},getSortable:function(){let e=[];return t(h).find("[data-sort-wrapper]").each(function(a){const o=t(this),n=`wc-repeater-sortable-${a}`;o.attr("id",n),e.push(n)}),e},initSortable:function(){const e=g.updateIndexFields;this.getSortable().forEach(function(i){t(`#${i}`).sortable({placeholder:"ui-state-highlight",forcePlaceholderSize:!0,tolerance:"pointer",handle:"[data-sort-handle]",cancel:".wc-repeater-section-header-title, .wc-repeater-field-type, .wc-repeater-field-toggle, .wc-repeater-field-close, .wc-repeater-field-visibility, .img-remove",update:function(){const a=t(this);if(a.attr("data-sort")==="gallery"){let o=[];t(this).find("img").each(function(){const n=t(this).attr("data-id");o.push(n)}),t(this).parent().find('input[type="hidden"]').val(o.join(","))}else a.attr("data-sort")==="stats"?(e(t(this)),u.reInit(),p.reInitSortable()):a.attr("data-sort")==="fields"&&(s.main(),u.reInit(),p.reInitSortable())},start:function(a,o){t(o.item).find("textarea").each(function(){tinymce.execCommand("mceRemoveEditor",!1,t(this).attr("id"))})},stop:function(a,o){t(o.item).find("textarea").each(function(){tinymce.execCommand("mceAddEditor",!0,t(this).attr("id"))})}})})},removeSortable:function(){this.getSortable().forEach(function(e){t(e).sortable("disable")})},reInitSortable:function(){this.removeSortable(),this.initSortable()},removeImage:function(){t(l).on("click","[data-remove-image-gallery]",function(){const e=t(this),i=e.parent(),a=i.find("img").attr("data-id"),o=e.parents(".wc-repeater-field-content-type"),n=o.find('input[type="hidden"]'),d=n.val()?n.val().split(","):[],c=d.filter(f=>f!==a);n.val(c.join(",")),i.remove()})},init:function(){this.main(),this.initSortable(),this.removeImage()}},u={get:function(){let e=[],i=1;return t(l).find(".wc-repeater-tinymce").each(function(o){const n=t(this);if(n.attr("id")===void 0){for(let d=1;d<999&&jQuery(`#wc-repeater-tinymce-${i}`).length!==0;d++)i++;n.attr("id",`wc-repeater-tinymce-${i}`),e.push(`wc-repeater-tinymce-${i}`)}}),e},init:function(){this.get().forEach(function(i){wp.editor.initialize(i,{tinymce:{wpautop:!0,plugins:"charmap colorpicker hr lists paste tabfocus textcolor fullscreen wordpress wpautoresize wpeditimage wpemoji wpgallery wplink wptextpattern",toolbar1:"formatselect,bold,italic,bullist,numlist,blockquote,alignleft,aligncenter,alignright,link,wp_more,spellchecker,fullscreen,wp_adv,listbuttons",toolbar2:"styleselect,strikethrough,hr,forecolor,pastetext,removeformat,charmap,outdent,indent,undo,redo,wp_help",textarea_rows:20},quicktags:{buttons:"strong,em,link,block,del,ins,img,ul,ol,li,code,more,close"},mediaButtons:!0})})},remove:function(){this.get().forEach(function(e){wp.editor.remove(e)})},reInit:function(){this.init()}},s={main:function(){const e=t("#wc-repeater").find("[data-section-wrapper]"),i=this.field;t.each(e,function(a,o){const n=t(o),d=n.find('[name*="community_field"]');i(d,0,a);const c=n.find("[data-section-field]");t.each(c,function(f,r){const m=t(r),k=m.find('[name*="community_field"]');i(k,2,f);const x=m.find("[data-section-stat]");t.each(x,function(I,_){const w=t(_),F=w.find('[name*="community_field"]');i(F,4,I);const C=w.find("[data-section-stats-child-item]");t.each(C,function(j,E){const T=t(E),U=T.find('[name*="community_field"]');i(U,6,j)})})})})},field:function(e,i,a){t.each(e,function(o,n){var d=t(n),c=d.attr("name");c=c.slice(16,-1).split("]["),c[i]=a,d.attr("name","community_field["+c.join("][")+"]")})}},y={addFields:function(){t("#wc-add-section button").on("click",function(){t(".wc-repeater-inside").append(communities_pt_data.section),s.main(),u.reInit(),p.reInitSortable()})},addSubFields:function(){t(l).on("click","[data-add-field]",function(){t(this).parents(".wc-repeater-section").find(".wc-repeater-fields").append(communities_pt_data.field),s.main(),u.reInit(),p.reInitSortable()})},updateTitle:function(){t(h).on("keyup","[data-head-title-input]",function(){const e=t(this).val();t(this).closest("[data-toggle-parent]").find("> div > [data-head-title-heading]").text(e===""?"No Title":e)})},init:function(){this.addFields(),this.addSubFields(),this.updateTitle()}},b={fieldType:function(){t(l).on("click",".wc-repeater-field-type-button",function(){const e=t(this);e.addClass("active"),e.closest(".wc-repeater-field-type").find(".wc-repeater-field-type-dropdown").slideDown("fast"),e.closest(".wc-repeater-field").addClass("field-open")}),t(l).on("click","[data-field-type]",function(){const e=t(this),i=e.attr("data-field-type"),a=e.closest(".wc-repeater-field-type"),o=e.parents(".wc-repeater-field");a.find("input[type=hidden]").val(i),a.find(".wc-repeater-field-type-button").text(e.text()),o.find(".wc-repeater-field-content-type").hide(),o.find(`.wc-repeater-field-content-type[data-id=${i}]`).slideDown(),t(".wc-repeater-field.field-open").removeClass("field-open"),t(".wc-repeater-field-type-button").removeClass("active"),t(".wc-repeater-field-type-dropdown").slideUp("fast")}),t(h).on("click",function(e){const i=t(".wc-repeater-field-type");i!==e.target&&!i.has(e.target).length&&(t(".wc-repeater-field-type-button").removeClass("active"),t(".wc-repeater-field-type-dropdown").slideUp("fast"))})},subField:function(){t(l).on("click","[data-toggle-field]",function(){const e=t(this),i=e.closest("[data-toggle-parent]");e.toggleClass("active"),i.find("> [data-toggle-body]").slideToggle("fast")})},deleteField:function(){t(l).on("click","[data-close-field]",function(){t(this).closest("[data-toggle-parent]").remove(),s.main()})},init:function(){this.fieldType(),this.subField(),this.deleteField()}},g={imageHandler:function(){let e;t(l).on("click","[data-add-stat-image]",function(){const i=t(this),a=i.parent(),o=a.find('input[type="hidden"]');e=wp.media({title:"Select or Upload Media",button:{text:"Insert Media"},multiple:!0}),e.on("select",function(){const n=e.state().get("selection").first().toJSON();a.find(" > div").append(`
							<img src="${n.url}" width="200" height="200">
						`),o.val(n.id)}),e.on("close",function(){const n=a.find(".wc-repeater-field-content-no-images");o.val()===""?n.show():n.hide()}),e.open()})},addStatFields:function(){t(l).on("click","[data-add-stat]",function(){parent=t(this).parents(".wc-stats-item").find(".wc-stats-child"),parent.append(communities_pt_data.stat_child),s.main()})},addStatSection:function(){t(l).on("click","[data-add-stat-section]",function(){parent=t(this).parents(".wc-repeater-field-content-type").find(".wc-stats-items"),parent.append(communities_pt_data.stat),s.main()})},updateIndexFields:function(e){const i=s.field;t.each(e.parents(".wc-repeater-field-content-type").find("[data-section-stat]"),function(a,o){const n=t(o),d=n.find('[name*="community_field"]');i(d,4,a),t.each(n.find("[data-section-stats-child-item]"),function(c,f){const r=t(f),m=r.find('[name*="community_field"]');i(m,6,c)})})},init:function(){this.imageHandler(),this.addStatFields(),this.addStatSection()}},S={init:function(){v.init(),y.init(),b.init(),p.init(),g.init(),u.init()}};t(document).ready(function(){S.init()})})(jQuery,window,document,"html","body");
