(function(t){t(document).ready(function(){const y=document.getElementById("post_ID"),b=y!==null?y.value:void 0;wp.media!==void 0&&(wp.media.view.settings.post.id=b!==void 0?b:null);var C=t(document);function B(){k(),T(),A(),I(),N(),S(),j(),D(),F()}function k(){t(".save-option-ajax").on("click",function(n){n.preventDefault();const i=t(this);i.attr("disabled","disabled");let e=i.parents(".wpui-tabs-container").find("*").serializeArray();i.parents(".wpui-tabs-container").find('input[type="checkbox"]:not(:checked)').map(function(){t.inArray(this.name,e)===-1&&this.name!==""&&e.push({name:this.name,value:this.checked?this.value:""})}),t.post(ajaxurl,{action:"aios_save_options",data:e}).done(function(o){swal({type:"success",title:"Updated",showConfirmButton:!1,timer:1500}),setTimeout(()=>{i.removeAttr("disabled")},1500)}).fail(function(o,a,u){swal({type:"error",title:"Error",showConfirmButton:!1,timer:1500}),setTimeout(()=>{i.removeAttr("disabled")},1500)})})}function T(){t(".setting-button").on("click","input[type=button]",function(){var n=t(this).parents(".setting-container-parent"),i=n.find(".setting-image-input"),e=n.find(".setting-image-preview"),o=n.parents("ul.cd-tabs-content");if(o.css({height:"auto"}),t(this).hasClass("setting-upload"))var a=wp.media({title:"Upload Image",multiple:!1}).open().on("select",function(u){var r=a.state().get("selection").first(),d=r.toJSON().url;i.val(d),e.empty(""),e.append('<img src="'+d+'">')});else t(this).hasClass("setting-remove")&&(i.val(""),e.empty(""),e.append("<p>No image uploaded</p>"))})}function A(){var n=t(".wpui-uploader-button");n.on("click","input[type=button]",function(){var i=t(this),e=i.parents(".wpui-uploader-container-parent"),o=e.find(".wpui-uploader-image-input"),a=e.find(".wpui-uploader-image-preview"),u=e.data("title")!==""?e.data("title"):"Media Gallery",r=e.data("type")!==""?e.data("type"):"image",d=e.data("button-text")!==""?e.data("button-text"):"Select",m=e.data("filter-page-text")!==""?e.data("filter-page-text"):"Uploaded to this "+(typenow!==void 0||typenow!==""?typenow:"page"),h=e.data("no-image")!==""?e.data("no-image"):"No image uploaded",c=e.parents("ul.cd-tabs-content");if(i.parent().attr("id")==="wpui-uploader-_thumbnail_id")i.hasClass("wpui-uploader-upload")?(wp.media.view.settings.post.featuredImageId=jQuery("#_thumbnail_id").val(),wp.media.view.settings.post.nonce=jQuery("#_wpnonce").val(),wp.media.featuredImage.frame().open().on("select",function(s){var l=wp.media.frame.state().get("selection").first(),p=l.toJSON();o.val(p.id),a.empty(""),a.append('<img src="'+p.url+'" style="max-width: 100%; margin-bottom: 10px;">')})):i.hasClass("wpui-uploader-remove")&&(wp.media.featuredImage.remove(),o.val(""),a.empty(""),a.append("<p>"+h+"</p>"));else if(c.css({height:"auto"}),i.hasClass("wpui-uploader-upload")){wp.media.view.AttachmentFilters.Uploaded=wp.media.view.AttachmentFilters.Uploaded.extend({createFilters:function(){var s={};s.all={text:"All Images",props:{status:null,type:"image",uploadedTo:null,orderby:"date",order:"DESC"},priority:10},s.uploaded={text:m,props:{status:null,type:"image",uploadedTo:wp.media.view.settings.post.id,orderby:"menuOrder",order:"ASC"},priority:20},this.filters=s},change:function(s){var l=this.filters[this.el.value];l&&(this.el.value==="all"?this.filters[this.el.value].props.post_parent="":this.filters[this.el.value].props.post_parent=wp.media.view.settings.post.id,this.model.set(l.props))},select:function(){var s=this.model,l="uploaded",p=s.toJSON();_.find(this.filters,function(w,g){var O=_.all(w.props,function(U,x){return U===(_.isUndefined(p[x])?null:p[x])});if(O)return l=g}),this.$el.val(l)}});var v=[new wp.media.controller.Library({title:u,filterable:"uploaded",library:wp.media.query({type:r,uploadedTo:wp.media.view.settings.post.id}),multiple:!0,contentUserSetting:!0})],f=wp.media({button:{text:d},state:"library",states:v,multiple:!0}).open().on("select",function(s){var l=f.state().get("selection").first(),p=l.toJSON();o.val(p.id),a.empty(""),a.append('<img src="'+p.url+'" style="max-width: 100%; margin-bottom: 10px;">')})}else i.hasClass("wpui-uploader-remove")&&(o.val(""),a.empty(""),a.append("<p>"+h+"</p>"))})}function I(){t(".wpui-template");var n=t(".wpui-template-activator:not(.wpui-template-disabled)"),i=t(".wpui-template-disabled"),e=t(".popup-close");i.on("click",function(o){o.preventDefault(),jQuery("#wpui-container-minimalist .popup-message-wrapper").fadeIn()}),e.on("click",function(o){jQuery("#wpui-container-minimalist .popup-message-wrapper").fadeOut()}),n.on("click",function(o){o.preventDefault();var a=t(this),u=a.attr("data-theme-slug"),r=a.attr("data-theme-name"),d=a.attr("data-theme-value");a.hasClass("wpui-template-activated")===!1?(u!==void 0&&t.post(ajaxurl,{action:"aios_generate_form",type:r,theme:u.toLowerCase()},function(m){var h=JSON.parse(m);h[0]==="generated"&&swal({type:"success",title:"Form Generated & Theme Update",text:"Theme will be activate after this page reload.",showConfirmButton:!1,timer:1500})}),t.post(ajaxurl,{action:"aios_save_options",option_name:r,option_value:d},function(m){JSON.parse(m),swal({type:"success",title:"Updated",text:"Theme will be activate after this page reload.",showConfirmButton:!1,timer:1500}),setTimeout(function(){location.reload()},1500)})):swal({type:"error",title:"Theme is currently active",showConfirmButton:!1,timer:1500})})}function N(){var n=t("#info-custom-fields"),i=t(".aios-siteinfo-custom-fields");t(".info-custom-fields-form-notifications");var e=/[ !@#$%^&*()+\-=\[\]{};':"\\|,.<>\/?1234567890]/,o=/[ !@#$%^&*()+\=\[\]{};':"\\|,.<>\/?1234567890]/;n.on("click",function(a){a.preventDefault();var u=t(this),r=u.parents(".info-custom-fields-form"),d=r.find("#info-custom-field-label"),m=d.val(),h=r.find("#info-custom-field-name"),c=h.val(),v=r.find("#info-custom-field-shortcode"),f=v.val(),s="";return o.test(c)||c==""||e.test(f)||f==""?((o.test(c)||c=="")&&(s+="Field Name does not empty or contains special characters except hyphen and underscore."),(e.test(f)||f=="")&&(s+="Field Shortcode does not empty or contains special characters."),swal({type:"error",title:"",text:s,showConfirmButton:!0})):t.post(ajaxurl,{action:"client_info_custom_fields",field_action:"add",label_value:m,name_value:c,shortcode_value:f},function(l){var p=JSON.parse(l);if(p[0]==="success"){var w='<div class="wpui-row wpui-row-box">								<div class="wpui-col-md-3">									<p><span class="wpui-settings-title">'+m.replace(/^\w/,g=>g.toUpperCase())+'</span><span id="deleteClientInfoFields" style="color: #f00; cursor: pointer;"  data-name="'+c+'">Delete</span></p>								</div>								<div class="wpui-col-md-9">									<div class="form-group">										<input type="text" name="aios_cicf['+c+']" id="aios_cicf['+c+']" 										value="">									</div>									<p class="float-left w-100 mt-2">Shortcode: <strong>[aios_cicf_'+f+"]</strong></p>								</div>							</div>";d.val(""),h.val(""),v.val(""),i.append(w),swal({type:"success",title:"Added",showConfirmButton:!1,timer:1500})}else p[0]==="duplicate"?swal({type:"error",title:"Duplicate",text:"field name or shortcodes",showConfirmButton:!0}):swal({type:"error",title:"No Action Taken",showConfirmButton:!1,timer:1500})}),!1})}function S(){C.on("click",".deleteClientInfoFields",function(){var n=t(this),i=n.attr("data-name");Swal({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(e=>{e.value&&t.post(ajaxurl,{action:"client_info_custom_fields",field_action:"remove",name_value:i},function(o){var a=JSON.parse(o);a[0]==="success"?(n.parents(".wpui-row-box").remove(),swal({type:"success",title:"Removed",showConfirmButton:!1,timer:1500})):swal({type:"error",title:"No Action Taken",showConfirmButton:!1,timer:1500})})})})}function j(){t(".aios-cf-leads-delete").on("click",function(n){const i=t(this),e=i.parents(".wpui-tabs-content"),o=e.find(".wpui-tabs-container"),a=o.find("input.leads:checkbox:checked").map(function(){return t(this).val()}).get();if(a.length===0)return swal({type:"error",title:"No lead selected",showConfirmButton:!1,timer:1500}),!1;t.post(ajaxurl,{action:"delete_leads",data:a}).done(function(u){swal({type:"success",title:"Deleted",showConfirmButton:!1,timer:1500}),setTimeout(()=>{window.location.reload()},1500)}).fail(function(u,r,d){swal({type:"error",title:"Error",showConfirmButton:!1,timer:1500}),setTimeout(()=>{i.removeAttr("disabled")},1500)})})}function D(){t("#dismiss-notif-from-is").on("click",function(n){n.preventDefault();const i=t(this);t.post(ajaxurl,{action:"dismiss_notification_from_ais"}).done(function(e){i.parent().hide()}).fail(function(e,o,a){swal({type:"error",title:"Error",showConfirmButton:!1,timer:1500})})})}function F(){const n=t('input[name="aioscm_used_custom_title"]'),i=t('input[name="aioscm_main_title"]').parent().parent().parent(),e=t('input[name="aioscm_sub_title"]').parent().parent().parent();i.hide(),e.hide(),n.prop("checked")&&(i.show(),e.show()),n.on("click",function(){t(this).prop("checked")?(i.show(),e.show()):(i.hide(),e.hide())})}B()})})(jQuery);
